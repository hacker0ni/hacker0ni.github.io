<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Implementing File Integrity Monitoring with Osquery" /><meta name="author" content="hacker0ni" /><meta property="og:locale" content="en" /><meta name="description" content="In this post I’d like to talk a bit about file integrity monitoring and how you can implement it using Osquery. Let’s jump in." /><meta property="og:description" content="In this post I’d like to talk a bit about file integrity monitoring and how you can implement it using Osquery. Let’s jump in." /><link rel="canonical" href="/posts/fim-osquery/" /><meta property="og:url" content="/posts/fim-osquery/" /><meta property="og:site_name" content="hacker0ni" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-21T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Implementing File Integrity Monitoring with Osquery" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@hacker0ni" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"hacker0ni"},"dateModified":"2022-02-22T02:50:03+00:00","datePublished":"2022-02-21T00:00:00+00:00","description":"In this post I’d like to talk a bit about file integrity monitoring and how you can implement it using Osquery. Let’s jump in.","headline":"Implementing File Integrity Monitoring with Osquery","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/fim-osquery/"},"url":"/posts/fim-osquery/"}</script><title>Implementing File Integrity Monitoring with Osquery | hacker0ni</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="hacker0ni"><meta name="application-name" content="hacker0ni"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/icon.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">hacker0ni</a></div><div class="site-subtitle font-italic">Home of Mustafa B. Polat</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/hacker0ni" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/hacker0ni" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Implementing File Integrity Monitoring with Osquery</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Implementing File Integrity Monitoring with Osquery</h1><div class="post-meta text-muted"><div> By <em> <a href="https://linkedin.com/in/hacker0ni">Mustafa B. Polat</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1645401600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-21 </em> </span> <span> Updated <em class="timeago" data-ts="1645498203" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1209 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p>In this post I’d like to talk a bit about file integrity monitoring and how you can implement it using Osquery. Let’s jump in.</p><p>Requirements:</p><ul><li><a href="https://osquery.io/">Osquery</a> installation<li>Basic understanding of the Linux filesystem</ul><h2 id="integrity"><span class="mr-2">Integrity</span><a href="#integrity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>One of the main legs of the <a href="https://securityscorecard.com/blog/what-is-the-cia-triad">CIA triad</a> is integrity. Maintaining the integrity of system files is important because these files decide the outcome of the binaries that we execute. Alongside these files, it’s also necessary to monitor the binaries on the system for changes. Even though the built-in binaries might get updated/modified over time, it is necessary to monitor the changes to determine the deviations from “normal”, which may be an indicator of a compromised system.</p><h2 id="installing-osquery"><span class="mr-2">Installing Osquery</span><a href="#installing-osquery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In order to follow along this guide, you need to <a href="https://osquery.readthedocs.io/en/stable/installation/install-linux/">install Osquery</a> on your favorite distribution. The default method of installation will provide two binaries on your system <code class="language-plaintext highlighter-rouge">osqueryi</code> and <code class="language-plaintext highlighter-rouge">osqueryd</code>. As you might infer from the names, <code class="language-plaintext highlighter-rouge">osqueryi</code> provides an interactive interface to run queries while <code class="language-plaintext highlighter-rouge">osqueryd</code> is the <a href="https://en.wikipedia.org/wiki/Daemon_(computing)">daemon</a> for the software. As of this writing, Osquery is a completely free and open-source software.</p><p>If the installation is done correctly, you should be able to run <code class="language-plaintext highlighter-rouge">osqueryi</code> from any directory since by default it’s added to the <code class="language-plaintext highlighter-rouge">PATH</code>. Run <code class="language-plaintext highlighter-rouge">osqueryi</code> to start the interactive Osquery shell and then you can use <code class="language-plaintext highlighter-rouge">.help</code> to better understand what’s available.</p><h2 id="fleetdm"><span class="mr-2">FleetDM</span><a href="#fleetdm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://fleetdm.com/">FleetDM</a> is another free and open-source project, though some pricing exists for extra features. This software aims to connect all your Osquery daemons to a centralized server, where you can run, schedule, and create packs with queries. This provides both flexibility and scalability of your Osquery deployment. It is not necessary to install this to follow along the guide, but it’s a rather useful software if you’re planning to deploy Osquery on your production environment.</p><h2 id="tables"><span class="mr-2">Tables</span><a href="#tables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Osquery provides hundreds of tables that you can query to gather information about your system. The language used to query these tables is SQLite. There are two main types of tables in Osquery. Evented tables and …well, tables. Regular tables hold information about the system that can be queried any time, while evented tables will help you generate logs based on certain events. We won’t delve into too much detail about the configuration steps, but it would be useful to check out the <a href="https://osquery.readthedocs.io/">documentations</a> in case you get stuck.</p><h3 id="evented-tables"><span class="mr-2">Evented Tables</span><a href="#evented-tables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Although evented tables may sound more enticing, they’re more performance hungry and may impact your server’s core functionality if configured incorrectly. One great example that can help us with file integrity monitoring is the <code class="language-plaintext highlighter-rouge">file_events</code> table. This table (when enabled) will track the changes on the filesystem and keep this information in the virtual database so that they can be queried to gather precise information about the changes.</p><p>Though I must admit, saying “Yeah, just use this table!” would be lazy. But this is the table that you want to query when looking for filesystem changes and to see what exactly changed within the file. You can specify which directories and sub-directories you want to monitor and it will check only for those files/directories.</p><h2 id="implementing-fim-without-an-evented-table"><span class="mr-2">Implementing FIM Without an Evented Table</span><a href="#implementing-fim-without-an-evented-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Osquery also provides us with other tables that contain the information we need and these are less resource hungry when queried, since they only check the system when the query runs. You can follow the <a href="https://osquery.readthedocs.io/en/stable/deployment/performance-safety/#testing-query-performance">query profiling documentation</a> to test your query’s performance impact on any given system.</p><p>Now onto to the real deal. One of the regular tables that come bundled with Osquery is the <code class="language-plaintext highlighter-rouge">file</code> table. This is a table that allows you to see quite a bit of information about a file, given that it’s path or directory is specified. For understanding what we’re doing next, I have to talk about “inodes”.</p><h3 id="inodes"><span class="mr-2">inodes</span><a href="#inodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Inode stands for “index node” and inodes in the Linux filesystem hold information about every file such as where on the disk the file is, attributes of the file, metadata, and the information that every digital forensic analyst loves to see - the <code class="language-plaintext highlighter-rouge">macb</code> information. Every file on the system has a corresponding inode that represents the file. <code class="language-plaintext highlighter-rouge">macb</code> is not an official name, but it’s one of the attributes of every file.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>m = Last Modified
a = Last Accessed
c = Last Changed
b = Birth
</pre></table></code></div></div><p>You can <code class="language-plaintext highlighter-rouge">stat</code> a file in Linux to see this information about a file. Like in the following example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>root@localhost:~# stat test.conf
  File: test.conf
  Size: 283             Blocks: 8          IO Block: 4096   regular file
Device: 800h/2048d      Inode: 9738        Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2022-02-21 20:16:28.572835183 +0000
Modify: 2022-02-21 20:16:20.908891089 +0000
Change: 2022-02-21 20:16:20.908891089 +0000
 Birth: -
</pre></table></code></div></div><p>As you can see, the Birth date might not be registered for every instance. <code class="language-plaintext highlighter-rouge">mtime</code> and the <code class="language-plaintext highlighter-rouge">ctime</code> might be a little confusing, but <code class="language-plaintext highlighter-rouge">mtime</code> represents the last time the file’s contents were modified, while the <code class="language-plaintext highlighter-rouge">ctime</code> will show you the last time the file’s property changed. <code class="language-plaintext highlighter-rouge">ctime</code> will change every time the <code class="language-plaintext highlighter-rouge">mtime</code> changes, but it will also change when the file’s permissions, location or name changes.</p><h3 id="file-table-and-files-to-look-for"><span class="mr-2">File Table and Files To Look For</span><a href="#file-table-and-files-to-look-for" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Osquery’s <a href="https://osquery.io/schema/5.1.0/#file">file</a> table includes the <code class="language-plaintext highlighter-rouge">macb</code> information about a file. Using these columns, we can detect when a file is modified. This table can also look for the attributes of the directories directly, which can help you understand if the contents of a directory has changed as well.</p><p>This is the different approach we’re going to take in implementing our file integrity monitoring. Key things about the whole ordeal:</p><ol><li>When a file inside a directory is modified or when a new file is created within a directory, the <code class="language-plaintext highlighter-rouge">mtime</code> of the directory also changes<li>When a file is modified it’s <code class="language-plaintext highlighter-rouge">mtime</code> changes <em>duh</em></ol><p>Using these 2 key factors we can implement two <a href="https://osquery.readthedocs.io/en/stable/deployment/logging/#differential-logs"><em>differentially</em></a> scheduled queries to achieve our goal.</p><h3 id="monitoring-files"><span class="mr-2">Monitoring Files</span><a href="#monitoring-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SELECT path, mode, mtime FROM file WHERE path IN ('/etc/passwd', '/etc/gpasswd', '/etc/group', '/etc/shadow', '/etc/gshadow', '/etc/sudoers');
</pre></table></code></div></div><p>You can monitor the above-mentioned files for detecting changes in them, since they’re the files that are less frequently modified and they hold sensitive information about the system.</p><p>There are more files in the <code class="language-plaintext highlighter-rouge">/etc</code> directory like initialization scripts that we can monitor, but I didn’t add those for the sake of simplicity. You can add more files you want to monitor between the parentheses to include them.</p><h3 id="monitoring-directories"><span class="mr-2">Monitoring Directories</span><a href="#monitoring-directories" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Although <code class="language-plaintext highlighter-rouge">file_events</code> may provide more precise information about the changes made to the directory contents, it’s still useful to monitor them with the <code class="language-plaintext highlighter-rouge">file</code> table since these directories are only modified when updates take place or new files are created.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SELECT path, mode, mtime FROM file WHERE path IN ('/usr/sbin', '/usr/bin', '/bin', '/sbin', '/boot');
</pre></table></code></div></div><p>If you’ve noticed, we’re still using the <code class="language-plaintext highlighter-rouge">path</code> column of the <code class="language-plaintext highlighter-rouge">file</code> table to specify the location we want to monitor, this is because looking at the directory’s path itself can help you monitor the <code class="language-plaintext highlighter-rouge">mtime</code> of the directory itself. Any change in this <code class="language-plaintext highlighter-rouge">mtime</code> value indicates a change in either directory itself or the contents of the directory.</p><p>That’s all! Feel free to message me on LinkedIn if you have any questions or issues you’d like me to fix. Cheers!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/guides/'>Guides</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/siem-part-I/">Building Your Own Open-Source SIEM, Part I: AAAAAH!</a><li><a href="/posts/fim-osquery/">Implementing File Integrity Monitoring with Osquery</a><li><a href="/posts/linux-memory-forensics/">Linux Memory Forensics</a><li><a href="/posts/imphashing/">Import hashing (aka imphashes)</a><li><a href="/posts/using-yara/">Using YARA</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/using-yara/"><div class="card-body"> <em class="timeago small" data-ts="1602720000" > 2020-10-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using YARA</h3><div class="text-muted small"><p> YARA is a multi-platform tool that lets you identify patterns in files. By identifying particular strings and signatures in a binary, you can determine the type of the file and gather a lot of info...</p></div></div></a></div><div class="card"> <a href="/posts/malware-lab/"><div class="card-body"> <em class="timeago small" data-ts="1624233600" > 2021-06-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building Your Own Dynamic Malware Analysis Lab</h3><div class="text-muted small"><p> Welcome back to my personal blog! In this blog post, I will introduce a couple of tools that you can use to analyze malware behavior at home. You will require a computer that can handle 2 virtual ...</p></div></div></a></div><div class="card"> <a href="/posts/siem-part-I/"><div class="card-body"> <em class="timeago small" data-ts="1650240000" > 2022-04-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building Your Own Open-Source SIEM, Part I: AAAAAH!</h3><div class="text-muted small"><p> Intro This will be a post series where I discuss the details of an open-source SIEM and how you can deploy it on your own infrastructure. This will heavily focus on Security Onion 2 as it gives us ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/linux-memory-forensics/" class="btn btn-outline-primary" prompt="Older"><p>Linux Memory Forensics</p></a> <a href="/posts/siem-part-I/" class="btn btn-outline-primary" prompt="Newer"><p>Building Your Own Open-Source SIEM, Part I: AAAAAH!</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://linkedin.com/in/hacker0ni">Mustafa B. Polat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-1N9MFZ196D"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1N9MFZ196D'); }); </script>
